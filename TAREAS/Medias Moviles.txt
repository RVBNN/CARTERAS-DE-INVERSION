Sub CMMPAd(k As Integer)' Media Movil Simple, calculada hacia adelante' Da una mayor importancia a los precios mas recientes en la serie de precios'+----------------+------------+--------+'| name                     | letter | column |'+----------------+------------+--------+'| Date                      | A      |      1 |'| Open                      | B      |      2 |'| High                      | C      |      3 |'| Low                       | D      |      4 |'| Close                     | E      |      5 |'| MMS Corta                 | F      |      6 |'| MMS Larga                 | G      |      7 |'| MMS Atras                 | H      |      8 |'| MMS Adelante              | I      |      9 |'| MM Exponencial            | J      |     10 |'+----------------+--------+--------+'Definimos la matriz de pesos    ReDim weights(1 To k, 1 To 1) As Double' Rotulo    Worksheets("Datos").Cells(1, 9) = "MMS Adelante (" & k & ")"    ' Tamaño de la serie de datos para los precios    N = Worksheets("Datos").Cells(Rows.Count, 1).End(xlUp).Row' Fijamos al ponderador W, que depende del tamaño k de la media movil    w = 2 / (k * (k + 1))    ' Creamos la serie de ponderadores    For i = 1 To k       weights(i, 1) = i * w    Next i    ' Llenamos la serie de datos -----------------------------------------------------------------    For i = k + 1 To N                rango_inicio = Worksheets("Datos").Cells(i + 1 - k, 5).Address        rango_fin = Worksheets("Datos").Range(rango_inicio).Offset(k - 1, 0).Address                precios = Worksheets("Datos").Range(rango_inicio, rango_fin)        result = Application.WorksheetFunction.SumProduct(precios, weights)                Worksheets("Datos").Cells(i, 9) = result            Next iEnd SubSub CMMPAt(k As Integer)' Media Movil Simple calculada hacia atras' Da una mayor importancia a los precios mas antiguos en la serie de precios'+----------------+------------+--------+'| name                     | letter | column |'+----------------+------------+--------+'| Date                      | A      |      1 |'| Open                      | B      |      2 |'| High                      | C      |      3 |'| Low                       | D      |      4 |'| Close                     | E      |      5 |'| MMS Corta                 | F      |      6 |'| MMS Larga                 | G      |      7 |'| MMS Atras                 | H      |      8 |'| MMS Adelante              | I      |      9 |'| MM Exponencial            | J      |     10 |'+----------------+--------+--------+' Definimos la matriz de pesos    ReDim weights(1 To k, 1 To 1) As Double    ' Rotulo    Worksheets("Datos").Cells(1, 8) = "MMS Atras (" & k & ")"' Tamaño de la serie de datos para los precios    N = Worksheets("Datos").Cells(Rows.Count, 1).End(xlUp).Row' Fijamos al ponderador W, que depende del tamaño k de la media movil    w = 2 / (k * (k + 1))    ' Creamos la serie de ponderadores    For i = 1 To k       weights(i, 1) = (k + 1 - i) * w    Next i    ' Llenamos la serie de datos -----------------------------------------------------------------    For i = k + 1 To N                rango_inicio = Worksheets("Datos").Cells(i + 1 - k, 5).Address        rango_fin = Worksheets("Datos").Range(rango_inicio).Offset(k - 1, 0).Address                precios = Worksheets("Datos").Range(rango_inicio, rango_fin)        result = Application.WorksheetFunction.SumProduct(precios, weights)                Worksheets("Datos").Cells(i, 8) = result            Next iEnd SubSub CMME(k As Integer)' Codigo para la media movil exponencial' Consideraciones:' Su principal función es generar pronósticos, se ajusta mejor a la serie de precios y le da mayor importancia a los datos más recientes.' K es el parametro que recibe la Media Movil Exponencial para realizar su analisis y tiene un impacto en alpha' alpha nos ayuda a sabeer el comportamiento de nuestros valores:    ' Si alpha -> 1, Pronositico se parece a los valores actuales de la serie    ' Si alpha -> 0, Pronositico se parece a los anteriores estimados    '+----------------+------------+--------+'| name                     | letter | column |'+----------------+------------+--------+'| Date                      | A      |      1 |'| Open                      | B      |      2 |'| High                      | C      |      3 |'| Low                       | D      |      4 |'| Close                     | E      |      5 |'| MMS Corta                 | F      |      6 |'| MMS Larga                 | G      |      7 |'| MMS Atras                 | H      |      8 |'| MMS Adelante              | I      |      9 |'| MM Exponencial            | J      |     10 |'+----------------+--------+--------+' Rotulo    Worksheets("Datos").Cells(1, 10) = "MME(" & k & ")"' Tamaño de la serie de datos    N = Worksheets("Datos").Cells(Rows.Count, 1).End(xlUp).Row' Llenamos la serie de datos -----------------------------------------------------------------    alpha = 2 / (k + 1)' Primer valor: MMS(k)    mms_inicio = Worksheets("Datos").Cells(2, 5).Address    mms_fin = Worksheets("Datos").Cells(k + 1, 5).Address    Set rango_mms = Range(mms_inicio, mms_fin)        mms = WorksheetFunction.Average(rango_mms)    Worksheets("Datos").Cells(k + 1, 10) = mms' Valores siguientes    For i = k + 2 To N                X = Worksheets("Datos").Cells(i, 5).Value        X_ = Worksheets("Datos").Cells(i - 1, 10).Value                Worksheets("Datos").Cells(i, 10) = alpha * X + (1 - alpha) * X_            Next iEnd Sub