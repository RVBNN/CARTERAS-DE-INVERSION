' Carteras de Inversion     Semestre 2023-1 PROCEDIMIENTOS VELAS' Equipo 10: Ruben NuÒez y Sofia PejcovichSub velas()Dim f1 As DateDim f2 As Date'Obtenemos la ventana de tiempo de nuestros precios historicosRange("A2").Selectt0 = ActiveCell.Valuetn = Selection.End(xlDown).Value' Inputs usuarioMsgBox ("Ingrese una fecha entre: " & t0 & " y " & tn)f1 = Application.InputBox("Ingresa fecha de inicio", "Ingrese parámetro de entrada (dd/mm/aa)", Type:=1)f2 = Application.InputBox("Ingresa fecha final", "Ingrese parámetro de entrada (dd/mm/aa)", Type:=1)' Validacion de inputs del usuarioIf f1 < t0 Or f2 > tn Then    MsgBox "Algún parámetro es incorrecto", vbCriticalElse' Tratamiento de fines de semana    Call Funciones.wknd(f1, f2)End If' Encuentra la celda correspondiente a la fecha de apertura    Range("A2").Select    fi = ActiveCell.Value    x = fi - f1        Do While x <> 0        x = fi - f1        ActiveCell.Offset(1, 0).Select        fi = ActiveCell.Value    Loop    p1 = ActiveCell.Address    ' Encuentra la celda correspondiente a la fecha de cierre    Range("A2").Select    fi = ActiveCell.Value    y = fi - f2        Do While y <> 0        y = fi - f2        ActiveCell.Offset(1, 0).Select        fi = ActiveCell.Value    Loop    p2 = ActiveCell.Address    ' Seleccionamos el rango de valores correspondientes a las fechasActiveSheet.Range(p1, p2).SelectRange(Selection, Selection.End(xlToRight)).Select' Borramos el gr·fico anteriorActiveSheet.ChartObjects("My_Chart").ActivateActiveChart.Parent.Delete' Agregamos el graficoActiveSheet.Shapes.AddChart2(322, xlStockOHLC).SelectActiveChart.ChartTitle.Text = "Velas Japonesas"ActiveChart.Parent.Name = "My_Chart"'ActiveChart.SetSourceData Source:=Range(Selection)ActiveChart.ChartArea.SelectWith ActiveChart.Parent    .Top = Range("G6").Top    .Left = Range("G6").Left    '.Height = Range("G6").Height    '.Width = Range("G6").WidthEnd WithRange("A1").SelectEnd Sub